{"ast":null,"code":"import _styled from \"@emotion/styled-base\";\nvar _jsxFileName = \"/Users/cliftoncampbell/Development/clif.world/_pages/Home/Globe.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport React, { Component } from 'react';\nimport get from 'lodash.get';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst countries = feature(lands, lands.objects.land);\n\nconst geojson = _objectSpread({}, countries, {\n  features: countries.features\n});\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const {\n    innerWidth,\n    innerHeight\n  } = window;\n\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = _styled(\"canvas\", {\n  target: \"eml2ifg0\",\n  label: \"Canvas\"\n})(false ? {\n  name: \"1ntfbxl\",\n  styles: \"fill:transparent;\"\n} : {\n  name: \"1ntfbxl\",\n  styles: \"fill:transparent;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jbGlmdG9uY2FtcGJlbGwvRGV2ZWxvcG1lbnQvY2xpZi53b3JsZC9fcGFnZXMvSG9tZS9HbG9iZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMEI0QiIsImZpbGUiOiIvVXNlcnMvY2xpZnRvbmNhbXBiZWxsL0RldmVsb3BtZW50L2NsaWYud29ybGQvX3BhZ2VzL0hvbWUvR2xvYmUuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBnZXQgZnJvbSAnbG9kYXNoLmdldCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBmZWF0dXJlIH0gZnJvbSAndG9wb2pzb24nO1xuaW1wb3J0IGxhbmRzIGZyb20gJy4vbmUxMTBtX2xhbmQuanNvbic7XG5cbmNvbnN0IGNvdW50cmllcyA9IGZlYXR1cmUobGFuZHMsIGxhbmRzLm9iamVjdHMubGFuZCk7XG5jb25zdCBnZW9qc29uID0ge1xuICAuLi5jb3VudHJpZXMsXG4gIGZlYXR1cmVzOiBjb3VudHJpZXMuZmVhdHVyZXMsXG59O1xuXG5jb25zdCBub3JtYWxpemVDdXJzb3JMb2NhdGlvbiA9IChbeCwgeV0pID0+IHtcbiAgY29uc3QgeyBpbm5lcldpZHRoLCBpbm5lckhlaWdodCB9ID0gd2luZG93O1xuICBjb25zdCBfeCA9ICh4IC0gaW5uZXJXaWR0aCAvIDIpIC8gKGlubmVyV2lkdGggLyAyKTtcbiAgY29uc3QgX3kgPSAtKHkgLSBpbm5lckhlaWdodCAvIDIpIC8gKGlubmVySGVpZ2h0IC8gMik7XG4gIHJldHVybiBbX3gsIF95XTtcbn07XG5cbmNvbnN0IGJ1ZmZlckNoYW5nZSA9ICh2YWwsIG9sZFZhbCkgPT4ge1xuICBjb25zdCBkaWZmZXJlbmNlID0gb2xkVmFsIC0gdmFsO1xuICBjb25zdCBtYXggPSAwLjE7XG4gIGNvbnN0IHNtYWxsZXJDaGFuZ2UgPSBkaWZmZXJlbmNlIDwgMCA/IG1heCA6IC1tYXg7XG4gIHJldHVybiBNYXRoLmFicyhkaWZmZXJlbmNlKSA+IG1heCA/IG9sZFZhbCArIHNtYWxsZXJDaGFuZ2UgOiB2YWw7XG59O1xuXG5jb25zdCBDYW52YXMgPSBzdHlsZWQuY2FudmFzYFxuICBmaWxsOiB0cmFuc3BhcmVudDtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsb2JlIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29vcmRzID0gWzAsIDBdO1xuXG4gIHJvdGF0aW9uWSA9IDA7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuZ2xvYmVTaXplID1cbiAgICAgIE1hdGgubWF4KHdpbmRvdy5pbm5lckhlaWdodCwgd2luZG93LmlubmVyV2lkdGgpICsgMjAwO1xuICAgIHRoaXMudHJhbnNsYXRlWCA9IHRoaXMuZ2xvYmVTaXplIC8gMjtcbiAgICB0aGlzLnRyYW5zbGF0ZVkgPSB0aGlzLmdsb2JlU2l6ZSAvIDI7XG4gICAgdGhpcy5yb3RhdGlvblggPSB0aGlzLmdsb2JlU2l6ZTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdCgnI2dsb2JlJyk7XG4gICAgY29uc3QgY29udGV4dCA9IHN2Zy5ub2RlKCkuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjb25zdCBwcm9qZWN0aW9uID0gZDNcbiAgICAgIC5nZW9PcnRob2dyYXBoaWMoKVxuICAgICAgLmZpdFNpemUoW3RoaXMuZ2xvYmVTaXplLCB0aGlzLmdsb2JlU2l6ZV0sIGdlb2pzb24pXG4gICAgICAucm90YXRlKFt0aGlzLnJvdGF0aW9uWCwgdGhpcy5yb3RhdGlvblldKVxuICAgICAgLmNsaXBBbmdsZSgxODApXG4gICAgICAudHJhbnNsYXRlKFt0aGlzLnRyYW5zbGF0ZVgsIHRoaXMudHJhbnNsYXRlWV0pO1xuICAgIGNvbnN0IHBhdGggPSBkMy5nZW9QYXRoKCkucHJvamVjdGlvbihwcm9qZWN0aW9uKS5jb250ZXh0KGNvbnRleHQpO1xuICAgIHRoaXMudGltZXIgPSBkMy50aW1lcigoKSA9PiB7XG4gICAgICBjb25zdCBjaGFuZ2UgPSB0aGlzLmNvb3Jkc1swXSA+PSAwID8gLTAuMDIgOiAwLjAyO1xuICAgICAgdGhpcy5yb3RhdGlvblggKz0gY2hhbmdlO1xuICAgICAgdGhpcy5yb3RhdGlvblkgPSBidWZmZXJDaGFuZ2UodGhpcy5jb29yZHNbMV0sIHRoaXMucm90YXRpb25ZKTtcbiAgICAgIHRoaXMudHJhbnNsYXRlWCA9IGJ1ZmZlckNoYW5nZShcbiAgICAgICAgdGhpcy5nbG9iZVNpemUgLyAyICsgdGhpcy5jb29yZHNbMF0sXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWCxcbiAgICAgICk7XG4gICAgICB0aGlzLnRyYW5zbGF0ZVkgPSBidWZmZXJDaGFuZ2UoXG4gICAgICAgIHRoaXMuZ2xvYmVTaXplIC8gMiArIHRoaXMuY29vcmRzWzFdLFxuICAgICAgICB0aGlzLnRyYW5zbGF0ZVksXG4gICAgICApO1xuICAgICAgcHJvamVjdGlvblxuICAgICAgICAucm90YXRlKFt0aGlzLnJvdGF0aW9uWCwgdGhpcy5yb3RhdGlvblldKVxuICAgICAgICAudHJhbnNsYXRlKFt0aGlzLnRyYW5zbGF0ZVgsIHRoaXMudHJhbnNsYXRlWV0pO1xuICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5nbG9iZVNpemUsIHRoaXMuZ2xvYmVTaXplKTtcbiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICBwYXRoKGNvdW50cmllcyk7XG4gICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICcjMTExJztcbiAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgY29udGV4dC5saW5lV2lkdGggPSAwLjU7XG4gICAgICBjb250ZXh0LnN0cm9rZUNvbG9yID0gJyMwMDAnO1xuICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMubW91c2VMaXN0ZW5lciA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ21vdXNlbW92ZScsXG4gICAgICB0aGlzLm9uR2xvYmFsTW91c2VNb3ZlLFxuICAgICk7XG4gICAgdGhpcy50b3VjaExpc3RlbmVyID0gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAndG91Y2htb3ZlJyxcbiAgICAgIHRoaXMub25HbG9iYWxUb3VjaE1vdmUsXG4gICAgKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNoTGlzdGVuZXIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlTGlzdGVuZXIpO1xuICAgIHRoaXMudGltZXIuc3RvcCgpO1xuICB9XG5cbiAgb25HbG9iYWxUb3VjaE1vdmUgPSAoZSkgPT4ge1xuICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gZ2V0KGUsICd0b3VjaGVzWzBdJyk7XG4gICAgaWYgKCFjbGllbnRYIHx8ICFjbGllbnRZKSByZXR1cm47XG4gICAgdGhpcy5jb29yZHMgPSBub3JtYWxpemVDdXJzb3JMb2NhdGlvbihbY2xpZW50WCwgY2xpZW50WV0pO1xuICB9O1xuXG4gIG9uR2xvYmFsTW91c2VNb3ZlID0gKHsgY2xpZW50WCwgY2xpZW50WSB9KSA9PiB7XG4gICAgdGhpcy5jb29yZHMgPSBub3JtYWxpemVDdXJzb3JMb2NhdGlvbihbY2xpZW50WCwgY2xpZW50WV0pO1xuICB9O1xuXG4gIGdldFBhdGhTdHJpbmcgPSAoKSA9PiB7fTtcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDYW52YXNcbiAgICAgICAgaWQ9XCJnbG9iZVwiXG4gICAgICAgIHdpZHRoPXtgJHt0aGlzLmdsb2JlU2l6ZX1gfVxuICAgICAgICBoZWlnaHQ9e2Ake3RoaXMuZ2xvYmVTaXplfWB9XG4gICAgICAgIHZpZXdCb3g9e2AwIDAgJHt0aGlzLmdsb2JlU2l6ZX0gJHt0aGlzLmdsb2JlU2l6ZX1gfVxuICAgICAgLz5cbiAgICApO1xuICB9XG59XG4iXX0= */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\n\nexport default class Globe extends Component {\n  constructor() {\n    super();\n\n    _defineProperty(this, \"coords\", [0, 0]);\n\n    _defineProperty(this, \"rotationY\", 0);\n\n    _defineProperty(this, \"onGlobalTouchMove\", e => {\n      const {\n        clientX,\n        clientY\n      } = get(e, 'touches[0]');\n      if (!clientX || !clientY) return;\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"onGlobalMouseMove\", ({\n      clientX,\n      clientY\n    }) => {\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"getPathString\", () => {});\n\n    this.globeSize = Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n  }\n\n  componentDidMount() {\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3.geoOrthographic().fitSize([this.globeSize, this.globeSize], geojson).rotate([this.rotationX, this.rotationY]).clipAngle(180).translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(this.globeSize / 2 + this.coords[0], this.translateX);\n      this.translateY = bufferChange(this.globeSize / 2 + this.coords[1], this.translateY);\n      projection.rotate([this.rotationX, this.rotationY]).translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n    this.mouseListener = window.addEventListener('mousemove', this.onGlobalMouseMove);\n    this.touchListener = window.addEventListener('touchmove', this.onGlobalTouchMove);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  render() {\n    return ___EmotionJSX(Canvas, {\n      id: \"globe\",\n      width: `${this.globeSize}`,\n      height: `${this.globeSize}`,\n      viewBox: `0 0 ${this.globeSize} ${this.globeSize}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 7\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/cliftoncampbell/Development/clif.world/_pages/Home/Globe.jsx"],"names":["React","Component","get","feature","lands","countries","objects","land","geojson","features","normalizeCursorLocation","x","y","innerWidth","innerHeight","window","_x","_y","bufferChange","val","oldVal","difference","max","smallerChange","Math","abs","Canvas","Globe","constructor","e","clientX","clientY","coords","globeSize","translateX","translateY","rotationX","componentDidMount","svg","d3","select","context","node","getContext","projection","geoOrthographic","fitSize","rotate","rotationY","clipAngle","translate","path","geoPath","timer","change","clearRect","beginPath","fillStyle","fill","lineWidth","strokeColor","stroke","mouseListener","addEventListener","onGlobalMouseMove","touchListener","onGlobalTouchMove","componentWillUnmount","removeEventListener","stop","render"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,GAAP,MAAgB,YAAhB;AAEA,SAASC,OAAT,QAAwB,UAAxB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;;AAEA,MAAMC,SAAS,GAAGF,OAAO,CAACC,KAAD,EAAQA,KAAK,CAACE,OAAN,CAAcC,IAAtB,CAAzB;;AACA,MAAMC,OAAO,qBACRH,SADQ;AAEXI,EAAAA,QAAQ,EAAEJ,SAAS,CAACI;AAFT,EAAb;;AAKA,MAAMC,uBAAuB,GAAG,CAAC,CAACC,CAAD,EAAIC,CAAJ,CAAD,KAAY;AAC1C,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAA8BC,MAApC;;AACA,QAAMC,EAAE,GAAG,CAACL,CAAC,GAAGE,UAAU,GAAG,CAAlB,KAAwBA,UAAU,GAAG,CAArC,CAAX;;AACA,QAAMI,EAAE,GAAG,EAAEL,CAAC,GAAGE,WAAW,GAAG,CAApB,KAA0BA,WAAW,GAAG,CAAxC,CAAX;;AACA,SAAO,CAACE,EAAD,EAAKC,EAAL,CAAP;AACD,CALD;;AAOA,MAAMC,YAAY,GAAG,CAACC,GAAD,EAAMC,MAAN,KAAiB;AACpC,QAAMC,UAAU,GAAGD,MAAM,GAAGD,GAA5B;AACA,QAAMG,GAAG,GAAG,GAAZ;AACA,QAAMC,aAAa,GAAGF,UAAU,GAAG,CAAb,GAAiBC,GAAjB,GAAuB,CAACA,GAA9C;AACA,SAAOE,IAAI,CAACC,GAAL,CAASJ,UAAT,IAAuBC,GAAvB,GAA6BF,MAAM,GAAGG,aAAtC,GAAsDJ,GAA7D;AACD,CALD;;AAOA,MAAMO,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAZ;;AAIA,eAAe,MAAMC,KAAN,SAAoB1B,SAApB,CAA8B;AAK3C2B,EAAAA,WAAW,GAAG;AACZ;;AADY,oCAJL,CAAC,CAAD,EAAI,CAAJ,CAIK;;AAAA,uCAFF,CAEE;;AAAA,+CA6DOC,CAAD,IAAO;AACzB,YAAM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,UAAuB7B,GAAG,CAAC2B,CAAD,EAAI,YAAJ,CAAhC;AACA,UAAI,CAACC,OAAD,IAAY,CAACC,OAAjB,EAA0B;AAC1B,WAAKC,MAAL,GAActB,uBAAuB,CAAC,CAACoB,OAAD,EAAUC,OAAV,CAAD,CAArC;AACD,KAjEa;;AAAA,+CAmEM,CAAC;AAAED,MAAAA,OAAF;AAAWC,MAAAA;AAAX,KAAD,KAA0B;AAC5C,WAAKC,MAAL,GAActB,uBAAuB,CAAC,CAACoB,OAAD,EAAUC,OAAV,CAAD,CAArC;AACD,KArEa;;AAAA,2CAuEE,MAAM,CAAE,CAvEV;;AAGZ,SAAKE,SAAL,GACET,IAAI,CAACF,GAAL,CAASP,MAAM,CAACD,WAAhB,EAA6BC,MAAM,CAACF,UAApC,IAAkD,GADpD;AAEA,SAAKqB,UAAL,GAAkB,KAAKD,SAAL,GAAiB,CAAnC;AACA,SAAKE,UAAL,GAAkB,KAAKF,SAAL,GAAiB,CAAnC;AACA,SAAKG,SAAL,GAAiB,KAAKH,SAAtB;AACD;;AAEDI,EAAAA,iBAAiB,GAAG;AAClB,UAAMC,GAAG,GAAGC,EAAE,CAACC,MAAH,CAAU,QAAV,CAAZ;AACA,UAAMC,OAAO,GAAGH,GAAG,CAACI,IAAJ,GAAWC,UAAX,CAAsB,IAAtB,CAAhB;AACA,UAAMC,UAAU,GAAGL,EAAE,CAClBM,eADgB,GAEhBC,OAFgB,CAER,CAAC,KAAKb,SAAN,EAAiB,KAAKA,SAAtB,CAFQ,EAE0BzB,OAF1B,EAGhBuC,MAHgB,CAGT,CAAC,KAAKX,SAAN,EAAiB,KAAKY,SAAtB,CAHS,EAIhBC,SAJgB,CAIN,GAJM,EAKhBC,SALgB,CAKN,CAAC,KAAKhB,UAAN,EAAkB,KAAKC,UAAvB,CALM,CAAnB;AAMA,UAAMgB,IAAI,GAAGZ,EAAE,CAACa,OAAH,GAAaR,UAAb,CAAwBA,UAAxB,EAAoCH,OAApC,CAA4CA,OAA5C,CAAb;AACA,SAAKY,KAAL,GAAad,EAAE,CAACc,KAAH,CAAS,MAAM;AAC1B,YAAMC,MAAM,GAAG,KAAKtB,MAAL,CAAY,CAAZ,KAAkB,CAAlB,GAAsB,CAAC,IAAvB,GAA8B,IAA7C;AACA,WAAKI,SAAL,IAAkBkB,MAAlB;AACA,WAAKN,SAAL,GAAiB9B,YAAY,CAAC,KAAKc,MAAL,CAAY,CAAZ,CAAD,EAAiB,KAAKgB,SAAtB,CAA7B;AACA,WAAKd,UAAL,GAAkBhB,YAAY,CAC5B,KAAKe,SAAL,GAAiB,CAAjB,GAAqB,KAAKD,MAAL,CAAY,CAAZ,CADO,EAE5B,KAAKE,UAFuB,CAA9B;AAIA,WAAKC,UAAL,GAAkBjB,YAAY,CAC5B,KAAKe,SAAL,GAAiB,CAAjB,GAAqB,KAAKD,MAAL,CAAY,CAAZ,CADO,EAE5B,KAAKG,UAFuB,CAA9B;AAIAS,MAAAA,UAAU,CACPG,MADH,CACU,CAAC,KAAKX,SAAN,EAAiB,KAAKY,SAAtB,CADV,EAEGE,SAFH,CAEa,CAAC,KAAKhB,UAAN,EAAkB,KAAKC,UAAvB,CAFb;AAGAM,MAAAA,OAAO,CAACc,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,KAAKtB,SAA7B,EAAwC,KAAKA,SAA7C;AACAQ,MAAAA,OAAO,CAACe,SAAR;AACAL,MAAAA,IAAI,CAAC9C,SAAD,CAAJ;AACAoC,MAAAA,OAAO,CAACgB,SAAR,GAAoB,MAApB;AACAhB,MAAAA,OAAO,CAACiB,IAAR;AACAjB,MAAAA,OAAO,CAACkB,SAAR,GAAoB,GAApB;AACAlB,MAAAA,OAAO,CAACmB,WAAR,GAAsB,MAAtB;AACAnB,MAAAA,OAAO,CAACoB,MAAR;AACD,KAvBY,CAAb;AAyBA,SAAKC,aAAL,GAAqB/C,MAAM,CAACgD,gBAAP,CACnB,WADmB,EAEnB,KAAKC,iBAFc,CAArB;AAIA,SAAKC,aAAL,GAAqBlD,MAAM,CAACgD,gBAAP,CACnB,WADmB,EAEnB,KAAKG,iBAFc,CAArB;AAID;;AAEDC,EAAAA,oBAAoB,GAAG;AACrBpD,IAAAA,MAAM,CAACqD,mBAAP,CAA2B,WAA3B,EAAwC,KAAKH,aAA7C;AACAlD,IAAAA,MAAM,CAACqD,mBAAP,CAA2B,WAA3B,EAAwC,KAAKN,aAA7C;AACA,SAAKT,KAAL,CAAWgB,IAAX;AACD;;AAcDC,EAAAA,MAAM,GAAG;AACP,WACE,cAAC,MAAD;AACE,MAAA,EAAE,EAAC,OADL;AAEE,MAAA,KAAK,EAAG,GAAE,KAAKrC,SAAU,EAF3B;AAGE,MAAA,MAAM,EAAG,GAAE,KAAKA,SAAU,EAH5B;AAIE,MAAA,OAAO,EAAG,OAAM,KAAKA,SAAU,IAAG,KAAKA,SAAU,EAJnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAQD;;AAvF0C","sourcesContent":["import React, { Component } from 'react';\nimport get from 'lodash.get';\nimport styled from '@emotion/styled';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\n\nconst countries = feature(lands, lands.objects.land);\nconst geojson = {\n  ...countries,\n  features: countries.features,\n};\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const { innerWidth, innerHeight } = window;\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = styled.canvas`\n  fill: transparent;\n`;\n\nexport default class Globe extends Component {\n  coords = [0, 0];\n\n  rotationY = 0;\n\n  constructor() {\n    super();\n\n    this.globeSize =\n      Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n  }\n\n  componentDidMount() {\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3\n      .geoOrthographic()\n      .fitSize([this.globeSize, this.globeSize], geojson)\n      .rotate([this.rotationX, this.rotationY])\n      .clipAngle(180)\n      .translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(\n        this.globeSize / 2 + this.coords[0],\n        this.translateX,\n      );\n      this.translateY = bufferChange(\n        this.globeSize / 2 + this.coords[1],\n        this.translateY,\n      );\n      projection\n        .rotate([this.rotationX, this.rotationY])\n        .translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n\n    this.mouseListener = window.addEventListener(\n      'mousemove',\n      this.onGlobalMouseMove,\n    );\n    this.touchListener = window.addEventListener(\n      'touchmove',\n      this.onGlobalTouchMove,\n    );\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  onGlobalTouchMove = (e) => {\n    const { clientX, clientY } = get(e, 'touches[0]');\n    if (!clientX || !clientY) return;\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  onGlobalMouseMove = ({ clientX, clientY }) => {\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  getPathString = () => {};\n\n  render() {\n    return (\n      <Canvas\n        id=\"globe\"\n        width={`${this.globeSize}`}\n        height={`${this.globeSize}`}\n        viewBox={`0 0 ${this.globeSize} ${this.globeSize}`}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}