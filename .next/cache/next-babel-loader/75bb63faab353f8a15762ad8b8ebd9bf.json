{"ast":null,"code":"import _styled from \"@emotion/styled-base\";\nvar _jsxFileName = \"/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst countries = feature(lands, lands.objects.land);\n\nconst geojson = _objectSpread({}, countries, {\n  features: countries.features\n});\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const {\n    innerWidth,\n    innerHeight\n  } = window;\n\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = _styled(\"canvas\", {\n  target: \"ehfpmxk0\",\n  label: \"Canvas\"\n})(false ? {\n  name: \"1ntfbxl\",\n  styles: \"fill:transparent;\"\n} : {\n  name: \"1ntfbxl\",\n  styles: \"fill:transparent;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jbGlmdG9uY2FtcGJlbGwvRGV2ZWxvcG1lbnQvY2xpZi53b3JsZC9fcGFnZXMvaG9tZS9HbG9iZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMkI0QiIsImZpbGUiOiIvVXNlcnMvY2xpZnRvbmNhbXBiZWxsL0RldmVsb3BtZW50L2NsaWYud29ybGQvX3BhZ2VzL2hvbWUvR2xvYmUuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBnZXQgZnJvbSAnbG9kYXNoLmdldCc7XG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBmZWF0dXJlIH0gZnJvbSAndG9wb2pzb24nO1xuaW1wb3J0IGxhbmRzIGZyb20gJy4vbmUxMTBtX2xhbmQuanNvbic7XG5cbmNvbnN0IGNvdW50cmllcyA9IGZlYXR1cmUobGFuZHMsIGxhbmRzLm9iamVjdHMubGFuZCk7XG5jb25zdCBnZW9qc29uID0ge1xuICAuLi5jb3VudHJpZXMsXG4gIGZlYXR1cmVzOiBjb3VudHJpZXMuZmVhdHVyZXMsXG59O1xuXG5jb25zdCBub3JtYWxpemVDdXJzb3JMb2NhdGlvbiA9IChbeCwgeV0pID0+IHtcbiAgY29uc3QgeyBpbm5lcldpZHRoLCBpbm5lckhlaWdodCB9ID0gd2luZG93O1xuICBjb25zdCBfeCA9ICh4IC0gaW5uZXJXaWR0aCAvIDIpIC8gKGlubmVyV2lkdGggLyAyKTtcbiAgY29uc3QgX3kgPSAtKHkgLSBpbm5lckhlaWdodCAvIDIpIC8gKGlubmVySGVpZ2h0IC8gMik7XG4gIHJldHVybiBbX3gsIF95XTtcbn07XG5cbmNvbnN0IGJ1ZmZlckNoYW5nZSA9ICh2YWwsIG9sZFZhbCkgPT4ge1xuICBjb25zdCBkaWZmZXJlbmNlID0gb2xkVmFsIC0gdmFsO1xuICBjb25zdCBtYXggPSAwLjE7XG4gIGNvbnN0IHNtYWxsZXJDaGFuZ2UgPSBkaWZmZXJlbmNlIDwgMCA/IG1heCA6IC1tYXg7XG4gIHJldHVybiBNYXRoLmFicyhkaWZmZXJlbmNlKSA+IG1heCA/IG9sZFZhbCArIHNtYWxsZXJDaGFuZ2UgOiB2YWw7XG59O1xuXG5jb25zdCBDYW52YXMgPSBzdHlsZWQuY2FudmFzYFxuICBmaWxsOiB0cmFuc3BhcmVudDtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsb2JlIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29vcmRzID0gWzAsIDBdO1xuXG4gIHJvdGF0aW9uWSA9IDA7XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5nbG9iZVNpemUgPVxuICAgICAgTWF0aC5tYXgod2luZG93LmlubmVySGVpZ2h0LCB3aW5kb3cuaW5uZXJXaWR0aCkgKyAyMDA7XG4gICAgdGhpcy50cmFuc2xhdGVYID0gdGhpcy5nbG9iZVNpemUgLyAyO1xuICAgIHRoaXMudHJhbnNsYXRlWSA9IHRoaXMuZ2xvYmVTaXplIC8gMjtcbiAgICB0aGlzLnJvdGF0aW9uWCA9IHRoaXMuZ2xvYmVTaXplO1xuXG4gICAgY29uc3Qgc3ZnID0gZDMuc2VsZWN0KCcjZ2xvYmUnKTtcbiAgICBjb25zdCBjb250ZXh0ID0gc3ZnLm5vZGUoKS5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGNvbnN0IHByb2plY3Rpb24gPSBkM1xuICAgICAgLmdlb09ydGhvZ3JhcGhpYygpXG4gICAgICAuZml0U2l6ZShbdGhpcy5nbG9iZVNpemUsIHRoaXMuZ2xvYmVTaXplXSwgZ2VvanNvbilcbiAgICAgIC5yb3RhdGUoW3RoaXMucm90YXRpb25YLCB0aGlzLnJvdGF0aW9uWV0pXG4gICAgICAuY2xpcEFuZ2xlKDE4MClcbiAgICAgIC50cmFuc2xhdGUoW3RoaXMudHJhbnNsYXRlWCwgdGhpcy50cmFuc2xhdGVZXSk7XG4gICAgY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgoKS5wcm9qZWN0aW9uKHByb2plY3Rpb24pLmNvbnRleHQoY29udGV4dCk7XG4gICAgdGhpcy50aW1lciA9IGQzLnRpbWVyKCgpID0+IHtcbiAgICAgIGNvbnN0IGNoYW5nZSA9IHRoaXMuY29vcmRzWzBdID49IDAgPyAtMC4wMiA6IDAuMDI7XG4gICAgICB0aGlzLnJvdGF0aW9uWCArPSBjaGFuZ2U7XG4gICAgICB0aGlzLnJvdGF0aW9uWSA9IGJ1ZmZlckNoYW5nZSh0aGlzLmNvb3Jkc1sxXSwgdGhpcy5yb3RhdGlvblkpO1xuICAgICAgdGhpcy50cmFuc2xhdGVYID0gYnVmZmVyQ2hhbmdlKFxuICAgICAgICB0aGlzLmdsb2JlU2l6ZSAvIDIgKyB0aGlzLmNvb3Jkc1swXSxcbiAgICAgICAgdGhpcy50cmFuc2xhdGVYLFxuICAgICAgKTtcbiAgICAgIHRoaXMudHJhbnNsYXRlWSA9IGJ1ZmZlckNoYW5nZShcbiAgICAgICAgdGhpcy5nbG9iZVNpemUgLyAyICsgdGhpcy5jb29yZHNbMV0sXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWSxcbiAgICAgICk7XG4gICAgICBwcm9qZWN0aW9uXG4gICAgICAgIC5yb3RhdGUoW3RoaXMucm90YXRpb25YLCB0aGlzLnJvdGF0aW9uWV0pXG4gICAgICAgIC50cmFuc2xhdGUoW3RoaXMudHJhbnNsYXRlWCwgdGhpcy50cmFuc2xhdGVZXSk7XG4gICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmdsb2JlU2l6ZSwgdGhpcy5nbG9iZVNpemUpO1xuICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgIHBhdGgoY291bnRyaWVzKTtcbiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJyMxMTEnO1xuICAgICAgY29udGV4dC5maWxsKCk7XG4gICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDAuNTtcbiAgICAgIGNvbnRleHQuc3Ryb2tlQ29sb3IgPSAnIzAwMCc7XG4gICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5tb3VzZUxpc3RlbmVyID0gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnbW91c2Vtb3ZlJyxcbiAgICAgIHRoaXMub25HbG9iYWxNb3VzZU1vdmUsXG4gICAgKTtcbiAgICB0aGlzLnRvdWNoTGlzdGVuZXIgPSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICd0b3VjaG1vdmUnLFxuICAgICAgdGhpcy5vbkdsb2JhbFRvdWNoTW92ZSxcbiAgICApO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMudG91Y2hMaXN0ZW5lcik7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW91c2VMaXN0ZW5lcik7XG4gICAgdGhpcy50aW1lci5zdG9wKCk7XG4gIH1cblxuICBvbkdsb2JhbFRvdWNoTW92ZSA9IChlKSA9PiB7XG4gICAgY29uc3QgeyBjbGllbnRYLCBjbGllbnRZIH0gPSBnZXQoZSwgJ3RvdWNoZXNbMF0nKTtcbiAgICBpZiAoIWNsaWVudFggfHwgIWNsaWVudFkpIHJldHVybjtcbiAgICB0aGlzLmNvb3JkcyA9IG5vcm1hbGl6ZUN1cnNvckxvY2F0aW9uKFtjbGllbnRYLCBjbGllbnRZXSk7XG4gIH07XG5cbiAgb25HbG9iYWxNb3VzZU1vdmUgPSAoeyBjbGllbnRYLCBjbGllbnRZIH0pID0+IHtcbiAgICB0aGlzLmNvb3JkcyA9IG5vcm1hbGl6ZUN1cnNvckxvY2F0aW9uKFtjbGllbnRYLCBjbGllbnRZXSk7XG4gIH07XG5cbiAgZ2V0UGF0aFN0cmluZyA9ICgpID0+IHt9O1xuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPENhbnZhc1xuICAgICAgICBpZD1cImdsb2JlXCJcbiAgICAgICAgd2lkdGg9e2Ake3RoaXMuZ2xvYmVTaXplfWB9XG4gICAgICAgIGhlaWdodD17YCR7dGhpcy5nbG9iZVNpemV9YH1cbiAgICAgICAgdmlld0JveD17YDAgMCAke3RoaXMuZ2xvYmVTaXplfSAke3RoaXMuZ2xvYmVTaXplfWB9XG4gICAgICAvPlxuICAgICk7XG4gIH1cbn1cbiJdfQ== */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\n\nexport default class Globe extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"coords\", [0, 0]);\n\n    _defineProperty(this, \"rotationY\", 0);\n\n    _defineProperty(this, \"onGlobalTouchMove\", e => {\n      const {\n        clientX,\n        clientY\n      } = get(e, 'touches[0]');\n      if (!clientX || !clientY) return;\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"onGlobalMouseMove\", ({\n      clientX,\n      clientY\n    }) => {\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"getPathString\", () => {});\n  }\n\n  componentDidMount() {\n    this.globeSize = Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3.geoOrthographic().fitSize([this.globeSize, this.globeSize], geojson).rotate([this.rotationX, this.rotationY]).clipAngle(180).translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(this.globeSize / 2 + this.coords[0], this.translateX);\n      this.translateY = bufferChange(this.globeSize / 2 + this.coords[1], this.translateY);\n      projection.rotate([this.rotationX, this.rotationY]).translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n    this.mouseListener = window.addEventListener('mousemove', this.onGlobalMouseMove);\n    this.touchListener = window.addEventListener('touchmove', this.onGlobalTouchMove);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  render() {\n    return ___EmotionJSX(Canvas, {\n      id: \"globe\",\n      width: `${this.globeSize}`,\n      height: `${this.globeSize}`,\n      viewBox: `0 0 ${this.globeSize} ${this.globeSize}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx"],"names":["React","Component","get","d3","feature","lands","countries","objects","land","geojson","features","normalizeCursorLocation","x","y","innerWidth","innerHeight","window","_x","_y","bufferChange","val","oldVal","difference","max","smallerChange","Math","abs","Canvas","Globe","e","clientX","clientY","coords","componentDidMount","globeSize","translateX","translateY","rotationX","svg","select","context","node","getContext","projection","geoOrthographic","fitSize","rotate","rotationY","clipAngle","translate","path","geoPath","timer","change","clearRect","beginPath","fillStyle","fill","lineWidth","strokeColor","stroke","mouseListener","addEventListener","onGlobalMouseMove","touchListener","onGlobalTouchMove","componentWillUnmount","removeEventListener","stop","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport styled from '@emotion/styled';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\n\nconst countries = feature(lands, lands.objects.land);\nconst geojson = {\n  ...countries,\n  features: countries.features,\n};\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const { innerWidth, innerHeight } = window;\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = styled.canvas`\n  fill: transparent;\n`;\n\nexport default class Globe extends Component {\n  coords = [0, 0];\n\n  rotationY = 0;\n\n  componentDidMount() {\n    this.globeSize =\n      Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3\n      .geoOrthographic()\n      .fitSize([this.globeSize, this.globeSize], geojson)\n      .rotate([this.rotationX, this.rotationY])\n      .clipAngle(180)\n      .translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(\n        this.globeSize / 2 + this.coords[0],\n        this.translateX,\n      );\n      this.translateY = bufferChange(\n        this.globeSize / 2 + this.coords[1],\n        this.translateY,\n      );\n      projection\n        .rotate([this.rotationX, this.rotationY])\n        .translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n\n    this.mouseListener = window.addEventListener(\n      'mousemove',\n      this.onGlobalMouseMove,\n    );\n    this.touchListener = window.addEventListener(\n      'touchmove',\n      this.onGlobalTouchMove,\n    );\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  onGlobalTouchMove = (e) => {\n    const { clientX, clientY } = get(e, 'touches[0]');\n    if (!clientX || !clientY) return;\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  onGlobalMouseMove = ({ clientX, clientY }) => {\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  getPathString = () => {};\n\n  render() {\n    return (\n      <Canvas\n        id=\"globe\"\n        width={`${this.globeSize}`}\n        height={`${this.globeSize}`}\n        viewBox={`0 0 ${this.globeSize} ${this.globeSize}`}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}