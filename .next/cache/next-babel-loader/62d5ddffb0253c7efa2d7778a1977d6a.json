{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _styled from \"@emotion/styled-base\";\nvar _jsxFileName = \"/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\nvar countries = feature(lands, lands.objects.land);\n\nvar geojson = _objectSpread({}, countries, {\n  features: countries.features\n});\n\nvar normalizeCursorLocation = function normalizeCursorLocation(_ref) {\n  var _ref2 = _slicedToArray(_ref, 2),\n      x = _ref2[0],\n      y = _ref2[1];\n\n  var _window = window,\n      innerWidth = _window.innerWidth,\n      innerHeight = _window.innerHeight;\n\n  var _x = (x - innerWidth / 2) / (innerWidth / 2);\n\n  var _y = -(y - innerHeight / 2) / (innerHeight / 2);\n\n  return [_x, _y];\n};\n\nvar bufferChange = function bufferChange(val, oldVal) {\n  var difference = oldVal - val;\n  var max = 0.1;\n  var smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nvar Canvas = _styled(\"canvas\", {\n  target: \"ehfpmxk0\",\n  label: \"Canvas\"\n})(false ? {\n  name: \"ivknjb\",\n  styles: \"fill:transparent;height:100%;width:100%;\"\n} : {\n  name: \"ivknjb\",\n  styles: \"fill:transparent;height:100%;width:100%;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jbGlmdG9uY2FtcGJlbGwvRGV2ZWxvcG1lbnQvY2xpZi53b3JsZC9fcGFnZXMvaG9tZS9HbG9iZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMkI0QiIsImZpbGUiOiIvVXNlcnMvY2xpZnRvbmNhbXBiZWxsL0RldmVsb3BtZW50L2NsaWYud29ybGQvX3BhZ2VzL2hvbWUvR2xvYmUuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBnZXQgZnJvbSAnbG9kYXNoLmdldCc7XG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBmZWF0dXJlIH0gZnJvbSAndG9wb2pzb24nO1xuaW1wb3J0IGxhbmRzIGZyb20gJy4vbmUxMTBtX2xhbmQuanNvbic7XG5cbmNvbnN0IGNvdW50cmllcyA9IGZlYXR1cmUobGFuZHMsIGxhbmRzLm9iamVjdHMubGFuZCk7XG5jb25zdCBnZW9qc29uID0ge1xuICAuLi5jb3VudHJpZXMsXG4gIGZlYXR1cmVzOiBjb3VudHJpZXMuZmVhdHVyZXMsXG59O1xuXG5jb25zdCBub3JtYWxpemVDdXJzb3JMb2NhdGlvbiA9IChbeCwgeV0pID0+IHtcbiAgY29uc3QgeyBpbm5lcldpZHRoLCBpbm5lckhlaWdodCB9ID0gd2luZG93O1xuICBjb25zdCBfeCA9ICh4IC0gaW5uZXJXaWR0aCAvIDIpIC8gKGlubmVyV2lkdGggLyAyKTtcbiAgY29uc3QgX3kgPSAtKHkgLSBpbm5lckhlaWdodCAvIDIpIC8gKGlubmVySGVpZ2h0IC8gMik7XG4gIHJldHVybiBbX3gsIF95XTtcbn07XG5cbmNvbnN0IGJ1ZmZlckNoYW5nZSA9ICh2YWwsIG9sZFZhbCkgPT4ge1xuICBjb25zdCBkaWZmZXJlbmNlID0gb2xkVmFsIC0gdmFsO1xuICBjb25zdCBtYXggPSAwLjE7XG4gIGNvbnN0IHNtYWxsZXJDaGFuZ2UgPSBkaWZmZXJlbmNlIDwgMCA/IG1heCA6IC1tYXg7XG4gIHJldHVybiBNYXRoLmFicyhkaWZmZXJlbmNlKSA+IG1heCA/IG9sZFZhbCArIHNtYWxsZXJDaGFuZ2UgOiB2YWw7XG59O1xuXG5jb25zdCBDYW52YXMgPSBzdHlsZWQuY2FudmFzYFxuICBmaWxsOiB0cmFuc3BhcmVudDtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsb2JlIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29vcmRzID0gWzAsIDBdO1xuXG4gIHJvdGF0aW9uWSA9IDA7XG5cbiAgc3RhdGUgPSB7XG4gICAgc2l6ZTogMCxcbiAgfTtcblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBjb25zdCBzaXplID1cbiAgICAgIE1hdGgubWF4KHdpbmRvdy5pbm5lckhlaWdodCwgd2luZG93LmlubmVyV2lkdGgpICsgMjAwO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzaXplIH0pO1xuICAgIHRoaXMudHJhbnNsYXRlWCA9IHNpemUgLyAyO1xuICAgIHRoaXMudHJhbnNsYXRlWSA9IHNpemUgLyAyO1xuICAgIHRoaXMucm90YXRpb25YID0gc2l6ZTtcblxuICAgIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdCgnI2dsb2JlJyk7XG4gICAgY29uc3QgY29udGV4dCA9IHN2Zy5ub2RlKCkuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBjb25zdCBwcm9qZWN0aW9uID0gZDNcbiAgICAgIC5nZW9PcnRob2dyYXBoaWMoKVxuICAgICAgLmZpdFNpemUoW3NpemUsIHNpemVdLCBnZW9qc29uKVxuICAgICAgLnJvdGF0ZShbdGhpcy5yb3RhdGlvblgsIHRoaXMucm90YXRpb25ZXSlcbiAgICAgIC5jbGlwQW5nbGUoMTgwKVxuICAgICAgLnRyYW5zbGF0ZShbdGhpcy50cmFuc2xhdGVYLCB0aGlzLnRyYW5zbGF0ZVldKTtcbiAgICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aCgpLnByb2plY3Rpb24ocHJvamVjdGlvbikuY29udGV4dChjb250ZXh0KTtcbiAgICB0aGlzLnRpbWVyID0gZDMudGltZXIoKCkgPT4ge1xuICAgICAgY29uc3QgY2hhbmdlID0gdGhpcy5jb29yZHNbMF0gPj0gMCA/IC0wLjAyIDogMC4wMjtcbiAgICAgIHRoaXMucm90YXRpb25YICs9IGNoYW5nZTtcbiAgICAgIHRoaXMucm90YXRpb25ZID0gYnVmZmVyQ2hhbmdlKHRoaXMuY29vcmRzWzFdLCB0aGlzLnJvdGF0aW9uWSk7XG4gICAgICB0aGlzLnRyYW5zbGF0ZVggPSBidWZmZXJDaGFuZ2UoXG4gICAgICAgIHNpemUgLyAyICsgdGhpcy5jb29yZHNbMF0sXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWCxcbiAgICAgICk7XG4gICAgICB0aGlzLnRyYW5zbGF0ZVkgPSBidWZmZXJDaGFuZ2UoXG4gICAgICAgIHNpemUgLyAyICsgdGhpcy5jb29yZHNbMV0sXG4gICAgICAgIHRoaXMudHJhbnNsYXRlWSxcbiAgICAgICk7XG4gICAgICBwcm9qZWN0aW9uXG4gICAgICAgIC5yb3RhdGUoW3RoaXMucm90YXRpb25YLCB0aGlzLnJvdGF0aW9uWV0pXG4gICAgICAgIC50cmFuc2xhdGUoW3RoaXMudHJhbnNsYXRlWCwgdGhpcy50cmFuc2xhdGVZXSk7XG4gICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBzaXplLCBzaXplKTtcbiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICBwYXRoKGNvdW50cmllcyk7XG4gICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICcjMTExJztcbiAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgY29udGV4dC5saW5lV2lkdGggPSAwLjU7XG4gICAgICBjb250ZXh0LnN0cm9rZUNvbG9yID0gJyMwMDAnO1xuICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMubW91c2VMaXN0ZW5lciA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ21vdXNlbW92ZScsXG4gICAgICB0aGlzLm9uR2xvYmFsTW91c2VNb3ZlLFxuICAgICk7XG4gICAgdGhpcy50b3VjaExpc3RlbmVyID0gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAndG91Y2htb3ZlJyxcbiAgICAgIHRoaXMub25HbG9iYWxUb3VjaE1vdmUsXG4gICAgKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLnRvdWNoTGlzdGVuZXIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlTGlzdGVuZXIpO1xuICAgIHRoaXMudGltZXIuc3RvcCgpO1xuICB9XG5cbiAgb25HbG9iYWxUb3VjaE1vdmUgPSAoZSkgPT4ge1xuICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gZ2V0KGUsICd0b3VjaGVzWzBdJyk7XG4gICAgaWYgKCFjbGllbnRYIHx8ICFjbGllbnRZKSByZXR1cm47XG4gICAgdGhpcy5jb29yZHMgPSBub3JtYWxpemVDdXJzb3JMb2NhdGlvbihbY2xpZW50WCwgY2xpZW50WV0pO1xuICB9O1xuXG4gIG9uR2xvYmFsTW91c2VNb3ZlID0gKHsgY2xpZW50WCwgY2xpZW50WSB9KSA9PiB7XG4gICAgdGhpcy5jb29yZHMgPSBub3JtYWxpemVDdXJzb3JMb2NhdGlvbihbY2xpZW50WCwgY2xpZW50WV0pO1xuICB9O1xuXG4gIGdldFBhdGhTdHJpbmcgPSAoKSA9PiB7fTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBzaXplIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAoXG4gICAgICA8Q2FudmFzXG4gICAgICAgIGlkPVwiZ2xvYmVcIlxuICAgICAgICB3aWR0aD17YCR7c2l6ZX1gfVxuICAgICAgICBoZWlnaHQ9e2Ake3NpemV9YH1cbiAgICAgICAgdmlld0JveD17YDAgMCAke3NpemV9ICR7c2l6ZX1gfVxuICAgICAgLz5cbiAgICApO1xuICB9XG59XG4iXX0= */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\n\nvar Globe = /*#__PURE__*/function (_Component) {\n  _inherits(Globe, _Component);\n\n  var _super = _createSuper(Globe);\n\n  function Globe() {\n    var _this;\n\n    _classCallCheck(this, Globe);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"coords\", [0, 0]);\n\n    _defineProperty(_assertThisInitialized(_this), \"rotationY\", 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      size: 0\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onGlobalTouchMove\", function (e) {\n      var _get = get(e, 'touches[0]'),\n          clientX = _get.clientX,\n          clientY = _get.clientY;\n\n      if (!clientX || !clientY) return;\n      _this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onGlobalMouseMove\", function (_ref3) {\n      var clientX = _ref3.clientX,\n          clientY = _ref3.clientY;\n      _this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getPathString\", function () {});\n\n    return _this;\n  }\n\n  _createClass(Globe, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var size = Math.max(window.innerHeight, window.innerWidth) + 200;\n      this.setState({\n        size: size\n      });\n      this.translateX = size / 2;\n      this.translateY = size / 2;\n      this.rotationX = size;\n      var svg = d3.select('#globe');\n      var context = svg.node().getContext('2d');\n      var projection = d3.geoOrthographic().fitSize([size, size], geojson).rotate([this.rotationX, this.rotationY]).clipAngle(180).translate([this.translateX, this.translateY]);\n      var path = d3.geoPath().projection(projection).context(context);\n      this.timer = d3.timer(function () {\n        var change = _this2.coords[0] >= 0 ? -0.02 : 0.02;\n        _this2.rotationX += change;\n        _this2.rotationY = bufferChange(_this2.coords[1], _this2.rotationY);\n        _this2.translateX = bufferChange(size / 2 + _this2.coords[0], _this2.translateX);\n        _this2.translateY = bufferChange(size / 2 + _this2.coords[1], _this2.translateY);\n        projection.rotate([_this2.rotationX, _this2.rotationY]).translate([_this2.translateX, _this2.translateY]);\n        context.clearRect(0, 0, size, size);\n        context.beginPath();\n        path(countries);\n        context.fillStyle = '#111';\n        context.fill();\n        context.lineWidth = 0.5;\n        context.strokeColor = '#000';\n        context.stroke();\n      });\n      this.mouseListener = window.addEventListener('mousemove', this.onGlobalMouseMove);\n      this.touchListener = window.addEventListener('touchmove', this.onGlobalTouchMove);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('touchmove', this.touchListener);\n      window.removeEventListener('mousemove', this.mouseListener);\n      this.timer.stop();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var size = this.state.size;\n      return ___EmotionJSX(Canvas, {\n        id: \"globe\",\n        width: \"\".concat(size),\n        height: \"\".concat(size),\n        viewBox: \"0 0 \".concat(size, \" \").concat(size),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return Globe;\n}(Component);\n\nexport { Globe as default };","map":{"version":3,"sources":["/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx"],"names":["React","Component","get","d3","feature","lands","countries","objects","land","geojson","features","normalizeCursorLocation","x","y","window","innerWidth","innerHeight","_x","_y","bufferChange","val","oldVal","difference","max","smallerChange","Math","abs","Canvas","Globe","size","e","clientX","clientY","coords","setState","translateX","translateY","rotationX","svg","select","context","node","getContext","projection","geoOrthographic","fitSize","rotate","rotationY","clipAngle","translate","path","geoPath","timer","change","clearRect","beginPath","fillStyle","fill","lineWidth","strokeColor","stroke","mouseListener","addEventListener","onGlobalMouseMove","touchListener","onGlobalTouchMove","removeEventListener","stop","state"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport styled from '@emotion/styled';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\n\nconst countries = feature(lands, lands.objects.land);\nconst geojson = {\n  ...countries,\n  features: countries.features,\n};\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const { innerWidth, innerHeight } = window;\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = styled.canvas`\n  fill: transparent;\n  height: 100%;\n  width: 100%;\n`;\n\nexport default class Globe extends Component {\n  coords = [0, 0];\n\n  rotationY = 0;\n\n  state = {\n    size: 0,\n  };\n\n  componentDidMount() {\n    const size =\n      Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.setState({ size });\n    this.translateX = size / 2;\n    this.translateY = size / 2;\n    this.rotationX = size;\n\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3\n      .geoOrthographic()\n      .fitSize([size, size], geojson)\n      .rotate([this.rotationX, this.rotationY])\n      .clipAngle(180)\n      .translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(\n        size / 2 + this.coords[0],\n        this.translateX,\n      );\n      this.translateY = bufferChange(\n        size / 2 + this.coords[1],\n        this.translateY,\n      );\n      projection\n        .rotate([this.rotationX, this.rotationY])\n        .translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, size, size);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n\n    this.mouseListener = window.addEventListener(\n      'mousemove',\n      this.onGlobalMouseMove,\n    );\n    this.touchListener = window.addEventListener(\n      'touchmove',\n      this.onGlobalTouchMove,\n    );\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  onGlobalTouchMove = (e) => {\n    const { clientX, clientY } = get(e, 'touches[0]');\n    if (!clientX || !clientY) return;\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  onGlobalMouseMove = ({ clientX, clientY }) => {\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  getPathString = () => {};\n\n  render() {\n    const { size } = this.state;\n    return (\n      <Canvas\n        id=\"globe\"\n        width={`${size}`}\n        height={`${size}`}\n        viewBox={`0 0 ${size} ${size}`}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}