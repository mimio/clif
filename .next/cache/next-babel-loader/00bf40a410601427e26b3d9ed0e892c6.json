{"ast":null,"code":"import _styled from \"@emotion/styled-base\";\nvar _jsxFileName = \"/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nimport React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\nimport { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst countries = feature(lands, lands.objects.land);\n\nconst geojson = _objectSpread({}, countries, {\n  features: countries.features\n});\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const {\n    innerWidth,\n    innerHeight\n  } = window;\n\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = _styled(\"canvas\", {\n  target: \"ehfpmxk0\",\n  label: \"Canvas\"\n})(false ? {\n  name: \"ivknjb\",\n  styles: \"fill:transparent;height:100%;width:100%;\"\n} : {\n  name: \"ivknjb\",\n  styles: \"fill:transparent;height:100%;width:100%;\",\n  map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jbGlmdG9uY2FtcGJlbGwvRGV2ZWxvcG1lbnQvY2xpZi53b3JsZC9fcGFnZXMvaG9tZS9HbG9iZS5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMkI0QiIsImZpbGUiOiIvVXNlcnMvY2xpZnRvbmNhbXBiZWxsL0RldmVsb3BtZW50L2NsaWYud29ybGQvX3BhZ2VzL2hvbWUvR2xvYmUuanN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IENvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBnZXQgZnJvbSAnbG9kYXNoLmdldCc7XG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL3N0eWxlZCc7XG5pbXBvcnQgeyBmZWF0dXJlIH0gZnJvbSAndG9wb2pzb24nO1xuaW1wb3J0IGxhbmRzIGZyb20gJy4vbmUxMTBtX2xhbmQuanNvbic7XG5cbmNvbnN0IGNvdW50cmllcyA9IGZlYXR1cmUobGFuZHMsIGxhbmRzLm9iamVjdHMubGFuZCk7XG5jb25zdCBnZW9qc29uID0ge1xuICAuLi5jb3VudHJpZXMsXG4gIGZlYXR1cmVzOiBjb3VudHJpZXMuZmVhdHVyZXMsXG59O1xuXG5jb25zdCBub3JtYWxpemVDdXJzb3JMb2NhdGlvbiA9IChbeCwgeV0pID0+IHtcbiAgY29uc3QgeyBpbm5lcldpZHRoLCBpbm5lckhlaWdodCB9ID0gd2luZG93O1xuICBjb25zdCBfeCA9ICh4IC0gaW5uZXJXaWR0aCAvIDIpIC8gKGlubmVyV2lkdGggLyAyKTtcbiAgY29uc3QgX3kgPSAtKHkgLSBpbm5lckhlaWdodCAvIDIpIC8gKGlubmVySGVpZ2h0IC8gMik7XG4gIHJldHVybiBbX3gsIF95XTtcbn07XG5cbmNvbnN0IGJ1ZmZlckNoYW5nZSA9ICh2YWwsIG9sZFZhbCkgPT4ge1xuICBjb25zdCBkaWZmZXJlbmNlID0gb2xkVmFsIC0gdmFsO1xuICBjb25zdCBtYXggPSAwLjE7XG4gIGNvbnN0IHNtYWxsZXJDaGFuZ2UgPSBkaWZmZXJlbmNlIDwgMCA/IG1heCA6IC1tYXg7XG4gIHJldHVybiBNYXRoLmFicyhkaWZmZXJlbmNlKSA+IG1heCA/IG9sZFZhbCArIHNtYWxsZXJDaGFuZ2UgOiB2YWw7XG59O1xuXG5jb25zdCBDYW52YXMgPSBzdHlsZWQuY2FudmFzYFxuICBmaWxsOiB0cmFuc3BhcmVudDtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsb2JlIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29vcmRzID0gWzAsIDBdO1xuXG4gIHJvdGF0aW9uWSA9IDA7XG5cbiAgc3RhdGUgPSB7XG4gICAgc2l6ZTogMCxcbiAgfTtcblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBjb25zdCBzaXplID1cbiAgICAgIE1hdGgubWF4KHdpbmRvdy5pbm5lckhlaWdodCwgd2luZG93LmlubmVyV2lkdGgpICsgMjAwO1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2l6ZSxcbiAgICB9KTtcbiAgICB0aGlzLnRyYW5zbGF0ZVggPSB0aGlzLmdsb2JlU2l6ZSAvIDI7XG4gICAgdGhpcy50cmFuc2xhdGVZID0gdGhpcy5nbG9iZVNpemUgLyAyO1xuICAgIHRoaXMucm90YXRpb25YID0gdGhpcy5nbG9iZVNpemU7XG5cbiAgICBjb25zdCBzdmcgPSBkMy5zZWxlY3QoJyNnbG9iZScpO1xuICAgIGNvbnN0IGNvbnRleHQgPSBzdmcubm9kZSgpLmdldENvbnRleHQoJzJkJyk7XG4gICAgY29uc3QgcHJvamVjdGlvbiA9IGQzXG4gICAgICAuZ2VvT3J0aG9ncmFwaGljKClcbiAgICAgIC5maXRTaXplKFt0aGlzLmdsb2JlU2l6ZSwgdGhpcy5nbG9iZVNpemVdLCBnZW9qc29uKVxuICAgICAgLnJvdGF0ZShbdGhpcy5yb3RhdGlvblgsIHRoaXMucm90YXRpb25ZXSlcbiAgICAgIC5jbGlwQW5nbGUoMTgwKVxuICAgICAgLnRyYW5zbGF0ZShbdGhpcy50cmFuc2xhdGVYLCB0aGlzLnRyYW5zbGF0ZVldKTtcbiAgICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aCgpLnByb2plY3Rpb24ocHJvamVjdGlvbikuY29udGV4dChjb250ZXh0KTtcbiAgICB0aGlzLnRpbWVyID0gZDMudGltZXIoKCkgPT4ge1xuICAgICAgY29uc3QgY2hhbmdlID0gdGhpcy5jb29yZHNbMF0gPj0gMCA/IC0wLjAyIDogMC4wMjtcbiAgICAgIHRoaXMucm90YXRpb25YICs9IGNoYW5nZTtcbiAgICAgIHRoaXMucm90YXRpb25ZID0gYnVmZmVyQ2hhbmdlKHRoaXMuY29vcmRzWzFdLCB0aGlzLnJvdGF0aW9uWSk7XG4gICAgICB0aGlzLnRyYW5zbGF0ZVggPSBidWZmZXJDaGFuZ2UoXG4gICAgICAgIHRoaXMuZ2xvYmVTaXplIC8gMiArIHRoaXMuY29vcmRzWzBdLFxuICAgICAgICB0aGlzLnRyYW5zbGF0ZVgsXG4gICAgICApO1xuICAgICAgdGhpcy50cmFuc2xhdGVZID0gYnVmZmVyQ2hhbmdlKFxuICAgICAgICB0aGlzLmdsb2JlU2l6ZSAvIDIgKyB0aGlzLmNvb3Jkc1sxXSxcbiAgICAgICAgdGhpcy50cmFuc2xhdGVZLFxuICAgICAgKTtcbiAgICAgIHByb2plY3Rpb25cbiAgICAgICAgLnJvdGF0ZShbdGhpcy5yb3RhdGlvblgsIHRoaXMucm90YXRpb25ZXSlcbiAgICAgICAgLnRyYW5zbGF0ZShbdGhpcy50cmFuc2xhdGVYLCB0aGlzLnRyYW5zbGF0ZVldKTtcbiAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIHRoaXMuZ2xvYmVTaXplLCB0aGlzLmdsb2JlU2l6ZSk7XG4gICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgcGF0aChjb3VudHJpZXMpO1xuICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAnIzExMSc7XG4gICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgIGNvbnRleHQubGluZVdpZHRoID0gMC41O1xuICAgICAgY29udGV4dC5zdHJva2VDb2xvciA9ICcjMDAwJztcbiAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLm1vdXNlTGlzdGVuZXIgPSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdtb3VzZW1vdmUnLFxuICAgICAgdGhpcy5vbkdsb2JhbE1vdXNlTW92ZSxcbiAgICApO1xuICAgIHRoaXMudG91Y2hMaXN0ZW5lciA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ3RvdWNobW92ZScsXG4gICAgICB0aGlzLm9uR2xvYmFsVG91Y2hNb3ZlLFxuICAgICk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy50b3VjaExpc3RlbmVyKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZUxpc3RlbmVyKTtcbiAgICB0aGlzLnRpbWVyLnN0b3AoKTtcbiAgfVxuXG4gIG9uR2xvYmFsVG91Y2hNb3ZlID0gKGUpID0+IHtcbiAgICBjb25zdCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IGdldChlLCAndG91Y2hlc1swXScpO1xuICAgIGlmICghY2xpZW50WCB8fCAhY2xpZW50WSkgcmV0dXJuO1xuICAgIHRoaXMuY29vcmRzID0gbm9ybWFsaXplQ3Vyc29yTG9jYXRpb24oW2NsaWVudFgsIGNsaWVudFldKTtcbiAgfTtcblxuICBvbkdsb2JhbE1vdXNlTW92ZSA9ICh7IGNsaWVudFgsIGNsaWVudFkgfSkgPT4ge1xuICAgIHRoaXMuY29vcmRzID0gbm9ybWFsaXplQ3Vyc29yTG9jYXRpb24oW2NsaWVudFgsIGNsaWVudFldKTtcbiAgfTtcblxuICBnZXRQYXRoU3RyaW5nID0gKCkgPT4ge307XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgc2l6ZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgPENhbnZhc1xuICAgICAgICBpZD1cImdsb2JlXCJcbiAgICAgICAgd2lkdGg9e2Ake3NpemV9YH1cbiAgICAgICAgaGVpZ2h0PXtgJHtzaXplfWB9XG4gICAgICAgIHZpZXdCb3g9e2AwIDAgJHtzaXplfSAke3NpemV9YH1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxufVxuIl19 */\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n});\n\nexport default class Globe extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"coords\", [0, 0]);\n\n    _defineProperty(this, \"rotationY\", 0);\n\n    _defineProperty(this, \"state\", {\n      size: 0\n    });\n\n    _defineProperty(this, \"onGlobalTouchMove\", e => {\n      const {\n        clientX,\n        clientY\n      } = get(e, 'touches[0]');\n      if (!clientX || !clientY) return;\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"onGlobalMouseMove\", ({\n      clientX,\n      clientY\n    }) => {\n      this.coords = normalizeCursorLocation([clientX, clientY]);\n    });\n\n    _defineProperty(this, \"getPathString\", () => {});\n  }\n\n  componentDidMount() {\n    const size = Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.setState({\n      size\n    });\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3.geoOrthographic().fitSize([this.globeSize, this.globeSize], geojson).rotate([this.rotationX, this.rotationY]).clipAngle(180).translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(this.globeSize / 2 + this.coords[0], this.translateX);\n      this.translateY = bufferChange(this.globeSize / 2 + this.coords[1], this.translateY);\n      projection.rotate([this.rotationX, this.rotationY]).translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n    this.mouseListener = window.addEventListener('mousemove', this.onGlobalMouseMove);\n    this.touchListener = window.addEventListener('touchmove', this.onGlobalTouchMove);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  render() {\n    const {\n      size\n    } = this.state;\n    return ___EmotionJSX(Canvas, {\n      id: \"globe\",\n      width: `${size}`,\n      height: `${size}`,\n      viewBox: `0 0 ${size} ${size}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 7\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/cliftoncampbell/Development/clif.world/_pages/home/Globe.jsx"],"names":["React","Component","get","d3","feature","lands","countries","objects","land","geojson","features","normalizeCursorLocation","x","y","innerWidth","innerHeight","window","_x","_y","bufferChange","val","oldVal","difference","max","smallerChange","Math","abs","Canvas","Globe","size","e","clientX","clientY","coords","componentDidMount","setState","translateX","globeSize","translateY","rotationX","svg","select","context","node","getContext","projection","geoOrthographic","fitSize","rotate","rotationY","clipAngle","translate","path","geoPath","timer","change","clearRect","beginPath","fillStyle","fill","lineWidth","strokeColor","stroke","mouseListener","addEventListener","onGlobalMouseMove","touchListener","onGlobalTouchMove","componentWillUnmount","removeEventListener","stop","render","state"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport get from 'lodash.get';\nimport * as d3 from 'd3';\nimport styled from '@emotion/styled';\nimport { feature } from 'topojson';\nimport lands from './ne110m_land.json';\n\nconst countries = feature(lands, lands.objects.land);\nconst geojson = {\n  ...countries,\n  features: countries.features,\n};\n\nconst normalizeCursorLocation = ([x, y]) => {\n  const { innerWidth, innerHeight } = window;\n  const _x = (x - innerWidth / 2) / (innerWidth / 2);\n  const _y = -(y - innerHeight / 2) / (innerHeight / 2);\n  return [_x, _y];\n};\n\nconst bufferChange = (val, oldVal) => {\n  const difference = oldVal - val;\n  const max = 0.1;\n  const smallerChange = difference < 0 ? max : -max;\n  return Math.abs(difference) > max ? oldVal + smallerChange : val;\n};\n\nconst Canvas = styled.canvas`\n  fill: transparent;\n  height: 100%;\n  width: 100%;\n`;\n\nexport default class Globe extends Component {\n  coords = [0, 0];\n\n  rotationY = 0;\n\n  state = {\n    size: 0,\n  };\n\n  componentDidMount() {\n    const size =\n      Math.max(window.innerHeight, window.innerWidth) + 200;\n    this.setState({\n      size,\n    });\n    this.translateX = this.globeSize / 2;\n    this.translateY = this.globeSize / 2;\n    this.rotationX = this.globeSize;\n\n    const svg = d3.select('#globe');\n    const context = svg.node().getContext('2d');\n    const projection = d3\n      .geoOrthographic()\n      .fitSize([this.globeSize, this.globeSize], geojson)\n      .rotate([this.rotationX, this.rotationY])\n      .clipAngle(180)\n      .translate([this.translateX, this.translateY]);\n    const path = d3.geoPath().projection(projection).context(context);\n    this.timer = d3.timer(() => {\n      const change = this.coords[0] >= 0 ? -0.02 : 0.02;\n      this.rotationX += change;\n      this.rotationY = bufferChange(this.coords[1], this.rotationY);\n      this.translateX = bufferChange(\n        this.globeSize / 2 + this.coords[0],\n        this.translateX,\n      );\n      this.translateY = bufferChange(\n        this.globeSize / 2 + this.coords[1],\n        this.translateY,\n      );\n      projection\n        .rotate([this.rotationX, this.rotationY])\n        .translate([this.translateX, this.translateY]);\n      context.clearRect(0, 0, this.globeSize, this.globeSize);\n      context.beginPath();\n      path(countries);\n      context.fillStyle = '#111';\n      context.fill();\n      context.lineWidth = 0.5;\n      context.strokeColor = '#000';\n      context.stroke();\n    });\n\n    this.mouseListener = window.addEventListener(\n      'mousemove',\n      this.onGlobalMouseMove,\n    );\n    this.touchListener = window.addEventListener(\n      'touchmove',\n      this.onGlobalTouchMove,\n    );\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('touchmove', this.touchListener);\n    window.removeEventListener('mousemove', this.mouseListener);\n    this.timer.stop();\n  }\n\n  onGlobalTouchMove = (e) => {\n    const { clientX, clientY } = get(e, 'touches[0]');\n    if (!clientX || !clientY) return;\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  onGlobalMouseMove = ({ clientX, clientY }) => {\n    this.coords = normalizeCursorLocation([clientX, clientY]);\n  };\n\n  getPathString = () => {};\n\n  render() {\n    const { size } = this.state;\n    return (\n      <Canvas\n        id=\"globe\"\n        width={`${size}`}\n        height={`${size}`}\n        viewBox={`0 0 ${size} ${size}`}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}